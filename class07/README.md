# 7回

## 物理ファイルシステムとは何か?

- ページ単位(4KB単位)でIOをする。
- メタデータ(inode)でIOを行う。

## ファイルシステムの階層

### 物理ファイルシステムとデバイスドライバの違い

物理ファイルシステムはデバイスに依存するものではない。それに対してデバイスドライバはデバイスに大きく依存する。

**=>階層化することによって隠している**

何を入出力の対象としているかが異なる。

### デバイスドライバ:

ディスク全体のデータを読み書きすることのみ.

### 物理ファイルシステム:

ファイルをかたまりとして認識, 番号(metadeta: inode)で管理, inodeの指し示す先(payload)

### 論理ファイルシステム:(Linux: VFS)

- ファイル名をつける(ディレクトリ管理)(パス名)
- キャッシュの実現(メモリ上にファイルの一部を持っておいて、まとめてHDDなどにIOをする。)

**-> Linuxの場合はシステムコールを受ける**

---

オブジェクト指向で書いたほうが良いのに、Clangで書かれている。

## システムコールのシナリオ

`open()`を実行するとディレクトリファイルのinodeを返す。そのディレクトリの内部にあるファイルを探す。

キャッシュを探す時は、メモリ上のキャッシュからinode番号をもとに検索する。キャッシュがあればデバイスにアクセスせずに終わる。

---

## プロセス管理

コマンドはそれぞれプロセスとして実行される。

`$ cat test.json`

catコマンドが実行されてプロセスになり、OSに実行されることで動く。

### プロセスは何か

- プロセスの実行単位
  - コマンドはそれぞれプロセスとして実行される

### `make &`と`make`の違い

シェルが返ってくるか、こないかの違い。バックグラウンドジョブであるからといって特別なことをしているわけではない。

  make &
  > 
  make
  ....

並列計算もプロセスをバックグラウンドで同時に動かせば簡易的に実現できる。プロセスは並列計算の単位と考えることも出来る。

### 関連システムコール

- exec プログラムを置き換えるシステムコール
- fork
- wait
- ...

### OSの働き

- プロセスの生成
- プロセスの処理をすすめる(プロセスにリソースを割り当てるか、どの程度の頻度で実行するか）
- プロセスからのシステムコールを処理する

### プロセスを作ること = 論理アドレス空間をつくる

CPU --[論理アドレス]--> MMU --[物理アドレス]--> 一次記憶装置
